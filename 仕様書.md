# 出退勤打刻アプリ 仕様書

## 1. システム概要

本システムは、スマートフォンからワンタップで出退勤の打刻を行い、管理者のLINEグループに通知を送信するアプリケーションです。打刻データはGoogleスプレッドシートに記録され、勤務時間が自動的に計算されます。また、PWA対応により、スマホのホーム画面にアプリのように追加できます。

Google Apps Script（GAS）を活用し、フロントエンドからバックエンド、データ管理までを統合的に実装。研修生が課題を完了した際には「課題完了ボタン」を押すことで管理者に通知が届き、メンターが確認後に合格判定を行う仕組みを備えています。

### 1.1. システムアーキテクチャ

- **実行環境**: Google Apps Script (GAS)
- **データベース**: Google Sheets
- **通知**: LINE Messaging API
- **フロントエンド**: HTML, CSS, JavaScript
- **ホスティング**: Google Apps Script Web App
- **PWA**: Progressive Web App (PWA) 対応

---

## 2. 目的

- LINEを使って簡単に出勤・退勤の打刻ができるようにする
- スマートフォンから手軽にアクセスできるPWAアプリを提供する
- 打刻データを自動的にスプレッドシートに記録し、管理者がリアルタイムで確認できるようにする
- 課題完了の報告を自動化し、メンターとの連携をスムーズにする

---

## 3. 画面構成

### 3.1. メイン画面レイアウト

```
┌─────────────────────────┐
│   📋 出退勤打刻アプリ   │  ← ヘッダー（緑グラデーション）
├─────────────────────────┤
│                         │
│   user01 / あなたの名前 │  ← ユーザー情報表示
│                         │
│   ┌─────┐  ┌─────┐    │
│   │🌅出勤│  │🌙退勤│    │  ← 打刻ボタン（横並び）
│   └─────┘  └─────┘    │
│                         │
│   ┌──────────────┐     │
│   │🎉 課題完了報告│     │  ← 課題完了ボタン（全幅）
│   └──────────────┘     │
│                         │
│   [ステータスメッセージ] │  ← 処理結果表示エリア
│                         │
├─────────────────────────┤
│ © 2025 勤怠管理システム │  ← フッター
└─────────────────────────┘
```

### 3.2. UI要素の詳細

| 要素 | 配置 | デザイン |
|------|------|----------|
| ヘッダー | 画面上部 | 緑グラデーション背景、白文字 |
| ユーザー情報 | ヘッダー下 | グレー背景、中央揃え |
| 出勤ボタン | 中央左側 | 緑グラデーション、🌅アイコン |
| 退勤ボタン | 中央右側 | 青グラデーション、🌙アイコン |
| 課題完了ボタン | 下部（全幅） | オレンジグラデーション、🎉アイコン |
| ステータス表示 | ボタン下 | 状態に応じた色分け（info/success/error） |

### 3.3. レスポンシブ対応

- 画面幅480px以下では、出勤・退勤ボタンが縦並びに変更
- スマートフォンに最適化されたタッチ操作UI
- PWA対応により、ホーム画面に追加してアプリのように利用可能

---

## 4. 入出力仕様

### 4.1. 入力

| 項目 | 入力方法 | 備考 |
|------|----------|------|
| 出勤打刻 | 「出勤」ボタンをタップ | ユーザーIDは固定（USER_ID） |
| 退勤打刻 | 「退勤」ボタンをタップ | 当日の出勤記録を自動検索 |
| 課題完了報告 | 「課題完了報告」ボタンをタップ | 確認ダイアログ表示 |

### 4.2. 出力

#### 4.2.1. スプレッドシート記録

**■ 研修生マスタシート**
| 列 | 項目 | 例 |
|----|------|-----|
| A | 研修生ID | user01 |
| B | 氏名 | 山田太郎 |

**■ 打刻記録シート**
| 列 | 項目 | 例 |
|----|------|-----|
| A | 日付 | 2025/01/15 |
| B | 研修生ID | user01 |
| C | 氏名 | 山田太郎 |
| D | 出勤時刻 | 09:00 |
| E | 退勤時刻 | 18:00 |
| F | 勤務時間 | 9時間0分 |

**■ 課題完了記録シート**
| 列 | 項目 | 例 |
|----|------|-----|
| A | 完了日時 | 2025/01/15 18:30 |
| B | 研修生ID | user01 |
| C | 氏名 | 山田太郎 |
| D | アプリURL | https://script.google.com/... |
| E | 判定 | （空欄：メンターが記入） |

#### 4.2.2. LINE通知内容

**■ 出勤通知**
```
【出勤】
山田太郎(user01)
2025/01/15 09:00
```

**■ 退勤通知**
```
【退勤】
山田太郎(user01)
出勤:09:00
退勤:18:00
勤務:9時間0分
```

**■ 課題完了通知**
```
【🎉課題完了報告🎉】
研修生:山田太郎(user01)
完了:2025/01/15 18:30

アプリURL:
https://script.google.com/macros/s/.../exec
```

#### 4.2.3. 画面表示

| 種類 | 表示内容 | 表示色 |
|------|----------|--------|
| 処理中 | 「送信中...」 | 青（info） |
| 成功 | 「出勤打刻が完了しました」 | 緑（success） |
| 成功 | 「退勤打刻が完了しました」 | 緑（success） |
| 成功 | 「課題完了報告を送信しました!」 | 緑（success） |
| エラー | 「エラー: ○○」 | 赤（error） |

---

## 5. 主要機能

### 5.1. 必須機能一覧

| No. | 機能名 | 説明 | 重要度 |
|-----|--------|------|--------|
| 1 | 出勤ボタンでLINE通知 | 出勤ボタン押下でLINEグループに通知が届く | ★★★ |
| 2 | 退勤ボタンで勤務時間計算 | 退勤ボタン押下で勤務時間が自動計算される | ★★★ |
| 3 | スプレッドシートに記録 | 打刻データがスプレッドシートに正しく記録される | ★★★ |
| 4 | 課題完了ボタンで通知 | 課題完了ボタン押下で管理者に通知が届く | ★★★ |
| 5 | PWAインストール | スマホにアプリとしてインストールできる | ★★★ |

### 5.2. 加点ポイント

| 項目 | 説明 |
|------|------|
| デザインの工夫 | UI/UXの改善、アニメーション効果、カラースキームの最適化 |
| エラーハンドリング | 通信エラー、データエラーの適切な処理と表示 |
| コードの可読性・保守性 | コメント、関数分割、命名規則の遵守 |

### 5.3. 出勤打刻機能

| 機能ID | 機能名 | 処理内容 |
|--------|--------|----------|
| F-001 | 出勤ボタン押下 | ボタンタップでPOSTリクエスト送信 |
| F-002 | 出勤時刻記録 | スプレッドシートに日付・時刻・ユーザー情報を追加 |
| F-003 | 出勤LINE通知 | 管理者のLINEグループに出勤情報を送信 |
| F-004 | 出勤完了表示 | 画面に成功メッセージを表示（5秒後に自動非表示） |

**■ 処理フロー**
1. ユーザーが「出勤」ボタンをタップ
2. フロントエンドがAPI(`action: 'start'`)を呼び出し
3. GASが研修生マスタから氏名を取得
4. 現在日時を取得（Asia/Tokyo タイムゾーン）
5. 打刻記録シートに追加（退勤時刻・勤務時間は空欄）
6. LINE Messaging APIで通知送信
7. 成功レスポンスを返却
8. 画面に「出勤打刻が完了しました」を表示

### 5.4. 退勤打刻機能

| 機能ID | 機能名 | 処理内容 |
|--------|--------|----------|
| F-011 | 退勤ボタン押下 | ボタンタップでPOSTリクエスト送信 |
| F-012 | 出勤記録検索 | 当日の未退勤レコードを検索 |
| F-013 | 勤務時間計算 | 出勤時刻と退勤時刻から勤務時間を算出 |
| F-014 | 退勤時刻記録 | スプレッドシートの該当レコードを更新 |
| F-015 | 退勤LINE通知 | 管理者のLINEグループに退勤情報・勤務時間を送信 |
| F-016 | 退勤完了表示 | 画面に成功メッセージを表示 |

**■ 処理フロー**
1. ユーザーが「退勤」ボタンをタップ
2. フロントエンドがAPI(`action: 'end'`)を呼び出し
3. GASが当日の出勤記録を検索（退勤時刻が空欄の最新行）
4. 該当レコードが見つからない場合はエラー返却
5. 勤務時間を計算（○時間△分 形式）
6. 打刻記録シートの該当行に退勤時刻・勤務時間を記録
7. LINE Messaging APIで通知送信
8. 成功レスポンスを返却
9. 画面に「退勤打刻が完了しました」を表示

**■ 勤務時間計算ロジック**
- 出勤時刻と退勤時刻を分単位に変換
- 差分を計算（日をまたぐ場合は+24時間）
- 時間と分に変換して「○時間△分」形式で返却

### 5.5. 課題完了報告機能

| 機能ID | 機能名 | 処理内容 |
|--------|--------|----------|
| F-021 | 課題完了ボタン押下 | 確認ダイアログ表示後、POSTリクエスト送信 |
| F-022 | 完了記録登録 | スプレッドシートに完了日時・アプリURLを記録 |
| F-023 | 完了LINE通知 | 管理者のLINEグループにアプリURLを含む通知を送信 |
| F-024 | 完了メッセージ表示 | 画面に成功メッセージを表示 |

**■ 処理フロー**
1. ユーザーが「課題完了報告」ボタンをタップ
2. 確認ダイアログ表示（キャンセル可能）
3. フロントエンドがAPI(`action: 'complete'`)を呼び出し
4. GASが研修生マスタから氏名を取得
5. 課題完了記録シートに日時・ユーザー情報・アプリURLを追加
6. LINE Messaging APIで通知送信（アプリURLを含む）
7. 成功レスポンスを返却
8. 画面に「課題完了報告を送信しました!」を表示

### 5.6. PWA対応機能

| 機能ID | 機能名 | 処理内容 |
|--------|--------|----------|
| F-031 | Service Worker登録 | オフライン対応・キャッシュ管理 |
| F-032 | マニフェスト配信 | PWAインストール情報を提供 |
| F-033 | ホーム画面追加 | スマホのホーム画面にアイコン追加可能 |
| F-034 | スタンドアロン動作 | ブラウザUIなしでアプリのように動作 |

**■ PWA機能詳細**
- `manifest.json`: アプリ名、アイコン、テーマカラー、表示モードを定義
- `service-worker.js`: キャッシュ戦略（Cache First）でオフライン対応
- アイコン: SVG形式（📋絵文字）、512x512サイズ
- テーマカラー: #4CAF50（緑）

### 5.7. LINE連携機能

| 機能ID | 機能名 | 処理内容 |
|--------|--------|----------|
| F-041 | LINE認証 | チャネルアクセストークンで認証 |
| F-042 | Push API呼び出し | 指定グループIDにメッセージを送信 |
| F-043 | エラーハンドリング | 通知失敗時のログ記録 |

**■ LINE API仕様**
- エンドポイント: `https://api.line.me/v2/bot/message/push`
- 認証方式: Bearer Token
- メッセージ形式: text type
- 送信先: グループID（`LINE_GROUP_ID`）

---

## 6. 使用技術

### 6.1. フロントエンド

| 技術 | バージョン/仕様 | 用途 |
|------|-----------------|------|
| HTML5 | - | アプリ画面の構造定義 |
| CSS3 | - | レスポンシブデザイン、グラデーション |
| JavaScript (ES6+) | Fetch API, async/await | API通信、イベント処理 |
| PWA | Manifest + Service Worker | オフライン対応、ホーム画面追加 |

**■ HTML構造**
- セマンティックタグ使用（header, main, footer）
- メタタグでビューポート・テーマカラー設定
- manifest.jsonとservice-worker.jsをリンク

**■ CSS設計**
- Flexboxレイアウト
- グラデーション背景（linear-gradient）
- メディアクエリでレスポンシブ対応（@media (max-width: 480px)）
- ホバー・アクティブ状態のアニメーション
- カラーパレット:
  - 緑系: #4CAF50, #45a049（出勤・ヘッダー）
  - 青系: #2196F3, #1976D2（退勤）
  - オレンジ系: #FF9800, #F57C00（課題完了）

**■ JavaScript機能**
- Fetch API: POSTリクエスト送信
- async/await: 非同期処理
- イベントリスナー: ボタンクリック処理
- DOM操作: ステータスメッセージ表示制御
- Service Worker登録: PWA対応
- URLエンコード: POSTデータのエンコーディング

### 6.2. バックエンド

| 技術 | 用途 |
|------|------|
| Google Apps Script (GAS) | サーバーサイド処理全般 |
| SpreadsheetApp | データベース操作 |
| UrlFetchApp | LINE API呼び出し |
| Utilities | 日時フォーマット |
| ContentService | HTTPレスポンス生成 |
| HtmlService | HTML配信 |

**■ GAS API活用**
- `doGet(e)`: GETリクエスト処理（HTML/CSS/JS配信）
- `doPost(e)`: POSTリクエスト処理（打刻・完了報告）
- `SpreadsheetApp.openById()`: スプレッドシート操作
- `UrlFetchApp.fetch()`: HTTP通信（LINE API）
- `Utilities.formatDate()`: 日時フォーマット（Asia/Tokyo）

### 6.3. 外部連携

| サービス | 用途 | 認証方式 |
|----------|------|----------|
| LINE Messaging API | プッシュ通知 | チャネルアクセストークン |
| Google Spreadsheet | データ永続化 | GASの自動認証 |

---

## 7. データ構造

### 7.1. クライアント側（localStorage）

**■ 使用状況**
- 本アプリでは **localStorageを使用していません**
- すべてのデータはスプレッドシートに保存
- ユーザーIDは固定値（`USER_ID = 'user01'`）

**■ 将来的な拡張案**
localStorageを活用する場合の想定データ構造:

```javascript
// ユーザー情報のキャッシュ
localStorage.setItem('user', JSON.stringify({
  userId: 'user01',
  userName: '山田太郎',
  lastSync: '2025-01-15T09:00:00+09:00'
}));

// 打刻履歴のキャッシュ（オフライン対応）
localStorage.setItem('pendingRecords', JSON.stringify([
  {
    action: 'start',
    timestamp: '2025-01-15T09:00:00+09:00',
    synced: false
  }
]));
```

### 7.2. サーバー側（Google Spreadsheet）

#### 7.2.1. 研修生マスタシート

| 列 | フィールド名 | データ型 | 必須 | 説明 |
|----|-------------|----------|------|------|
| A | 研修生ID | 文字列 | ○ | 一意の識別子（例: user01） |
| B | 氏名 | 文字列 | ○ | フルネーム |
| C | ステータス | 文字列 | - | 進行中、完了など |

**■ サンプルデータ**
```
| 研修生ID | 氏名       | ステータス |
|----------|-----------|----------|
| user01   | あなたの名前 | 進行中    |
| user02   | 佐藤花子   | 完了      |
```

#### 7.2.2. 打刻記録シート

| 列 | フィールド名 | データ型 | 必須 | 説明 |
|----|-------------|----------|------|------|
| A | 日付 | 日付 | ○ | yyyy/MM/dd形式 |
| B | 研修生ID | 文字列 | ○ | マスタと紐づく |
| C | 氏名 | 文字列 | ○ | マスタから取得 |
| D | 出勤時刻 | 時刻 | ○ | HH:mm形式 |
| E | 退勤時刻 | 時刻 | - | HH:mm形式（退勤時に記録） |
| F | 勤務時間 | 文字列 | - | ○時間△分形式 |

**■ データ追加ロジック**
- **出勤時**: A-D列を記録、E-F列は空欄
- **退勤時**: 該当行のE-F列を更新

**■ サンプルデータ**
```
| 日付        | 研修生ID | 氏名       | 出勤時刻 | 退勤時刻 | 勤務時間  |
|------------ |---------|-----------|---------|---------|----------|
| 2025/11/09  | user01  | あなたの名前 | 09:00   | 18:00   | 9時間0分  |
| 2025/11/10  | user01  | あなたの名前 | 08:30   | 17:30   | 9時間0分  |
```

#### 7.2.3. 課題完了記録シート

| 列 | フィールド名 | データ型 | 必須 | 説明 |
|----|-------------|----------|------|------|
| A | 完了日時 | 日時 | ○ | yyyy/MM/dd HH:mm形式 |
| B | 研修生ID | 文字列 | ○ | マスタと紐づく |
| C | 氏名 | 文字列 | ○ | マスタから取得 |
| D | アプリURL | 文字列 | ○ | デプロイ済みアプリのURL |
| E | 判定 | 文字列 | - | メンターが手動で記入 |

**■ サンプルデータ**
```
| 完了日時          | 研修生ID | 氏名       | アプリURL                                                 | 判定 |
|------------------|---------|-----------|----------------------------------------------------------|-----|
| 2025/11/09 15:30 | user01  | あなたの名前 | https://script.google.com/macros/s/.../exec              | 合格 |
```

### 7.3. 設定値（GASスクリプトプロパティ）

| 定数名 | 説明 | 設定必須 |
|--------|------|----------|
| LINE_CHANNEL_ACCESS_TOKEN | LINEチャネルアクセストークン | ○ |
| LINE_GROUP_ID | LINE通知先のグループID | ○ |
| SPREADSHEET_ID | データ保存先スプレッドシートID | ○ |
| USER_ID | 研修生ID（固定値） | ○ |
| APP_URL | デプロイ後のアプリURL | ○ |

---

## 8. API仕様

### 8.1. エンドポイント

| メソッド | パス | 説明 |
|---------|------|------|
| GET | `/` | index.htmlを返す |
| GET | `/?path=manifest.json` | PWAマニフェストを返す |
| GET | `/?path=service-worker.js` | Service Workerを返す |
| GET | `/?path=style.css` | CSSファイルを返す |
| POST | `/` | 打刻・完了報告処理 |

### 8.2. POSTリクエスト仕様

**■ リクエスト形式**
```javascript
// Content-Type: application/x-www-form-urlencoded
{
  data: encodeURIComponent(JSON.stringify({
    action: 'start' | 'end' | 'complete',
    appUrl: 'https://...' // completeの場合のみ
  }))
}
```

**■ レスポンス形式**
```javascript
// Content-Type: application/json
{
  success: true | false,
  message: '出勤打刻が完了しました' | 'エラーメッセージ'
}
```

### 8.3. アクション別仕様

| action | 処理内容 | 必須パラメータ | レスポンス例 |
|--------|----------|---------------|-------------|
| start | 出勤打刻 | なし | `{success: true, message: '出勤打刻が完了しました'}` |
| end | 退勤打刻 | なし | `{success: true, message: '退勤打刻が完了しました'}` |
| complete | 課題完了 | appUrl | `{success: true, message: '課題完了報告を送信しました!'}` |

---

## 9. エラーハンドリング

### 9.1. クライアント側エラー

| エラーケース | 表示メッセージ | 処理 |
|-------------|---------------|------|
| ネットワークエラー | 「通信エラー: ○○」 | 赤色でエラー表示 |
| JSONパースエラー | 「レスポンスのパースに失敗しました」 | デプロイURL確認を促す |
| ボタン二重押下 | - | ボタンを無効化して防止 |

### 9.2. サーバー側エラー

| エラーケース | レスポンスメッセージ | HTTPステータス |
|-------------|---------------------|---------------|
| POSTデータなし | 「リクエストデータがありません」 | 200（JSON） |
| 不正なアクション | 「不正なアクションです」 | 200（JSON） |
| 研修生情報なし | 「研修生情報が見つかりません」 | 200（JSON） |
| 出勤記録なし | 「本日の出勤記録が見つかりません」 | 200（JSON） |
| 例外発生 | 「エラーが発生しました: ○○」 | 200（JSON） |

**■ エラーログ**
- すべてのエラーは`Logger.log()`でGASログに記録
- LINE API失敗時もログに記録（アプリは正常動作）

---

## 10. セキュリティ

### 10.1. 認証・認可

| 項目 | 実装状況 | 備考 |
|------|---------|------|
| ユーザー認証 | 未実装 | 固定ID（USER_ID）を使用 |
| LINE認証 | 実装済み | チャネルアクセストークン |
| スプレッドシート権限 | GAS自動認証 | スクリプト実行者の権限 |

**■ セキュリティ上の注意点**
- アクセストークンはコード内にハードコーディング（本番環境ではプロパティストアを推奨）
- ユーザー認証なし（研修用のため）
- デプロイ時は「全員がアクセス可能」設定が必要

### 10.2. データ保護

- スプレッドシートへのアクセスはGAS経由のみ
- LINEグループIDの漏洩に注意
- HTTPS通信（GASデプロイ時に自動）

---

## 11. 事前準備

### 11.1. LINE公式アカウントの作成とアクセストークンの取得

1. [LINE Developers Console](https://developers.line.biz/)にアクセス
2. 新規プロバイダーを作成
3. Messaging APIチャネルを作成
4. チャネルアクセストークンを発行・取得
5. LINEグループにBotを招待
6. グループIDを取得（LINE Bot招待後、テストメッセージで確認）

### 11.2. Googleスプレッドシートの設定

1. 新しいGoogleスプレッドシートを作成
2. 以下の3つのシートを作成:
   - **研修生マスタ**: A列に「研修生ID」、B列に「氏名」、C列に「ステータス」
   - **打刻記録**: A列に「日付」、B列に「研修生ID」、C列に「氏名」、D列に「出勤時刻」、E列に「退勤時刻」、F列に「勤務時間」
   - **課題完了記録**: A列に「完了日時」、B列に「研修生ID」、C列に「氏名」、D列に「アプリURL」、E列に「判定」
3. スプレッドシートのIDをURLから取得（`https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}/edit`）

### 11.3. Google Apps Scriptの設定・デプロイ

1. Apps Scriptプロジェクト作成
2. code.gsをコピー&ペースト
3. 設定値を更新:
   ```javascript
   const LINE_CHANNEL_ACCESS_TOKEN = '取得したトークン';
   const LINE_GROUP_ID = '取得したグループID';
   const SPREADSHEET_ID = '取得したスプレッドシートID';
   ```
4. デプロイ実行:
   - 「新しいデプロイ」→「ウェブアプリ」
   - アクセス権限: 「全員」
   - デプロイURLをコピー

5. APP_URLを更新:
   ```javascript
   const APP_URL = 'デプロイしたURL';
   ```
6. 再デプロイ

---

## 12. システム運用

### 12.1. 運用フロー

1. **出勤打刻**: ユーザーが出勤ボタンを押すとLINE通知が送信され、スプレッドシートに記録
2. **退勤打刻**: 退勤ボタンを押すと勤務時間が計算され、LINE通知が送信され、スプレッドシートに記録
3. **課題完了報告**: ユーザーが課題完了ボタンを押すと、管理者にアプリURLと共に通知

### 12.2. 定期的なメンテナンス

- **データバックアップ**: スプレッドシートデータの定期バックアップ
- **トリガー設定**: Google Apps Scriptで定期的に出退勤データの処理を自動化（必要に応じて）
- **ログ確認**: GASの実行ログを定期的に確認し、エラーの早期発見

---

## 13. テスト・デバッグ

### 13.1. 機能テスト項目

| テスト項目 | 確認内容 | 期待結果 |
|-----------|---------|---------|
| 出勤打刻 | 出勤ボタン押下 | LINE通知送信、スプレッドシートに記録、成功メッセージ表示 |
| 退勤打刻 | 退勤ボタン押下 | 勤務時間計算、LINE通知送信、スプレッドシート更新 |
| 課題完了 | 課題完了ボタン押下 | LINE通知送信、スプレッドシートに記録 |
| PWA | ホーム画面追加 | アプリとして起動可能 |
| エラー処理 | ネットワーク切断時 | エラーメッセージ表示 |

### 13.2. デバッグ方法

1. **ブラウザ開発者ツール**: Console、Networkタブでエラー確認
2. **GASログ**: `Logger.log()`の出力を実行ログで確認
3. **LINE通知テスト**: 手動でメッセージ送信APIをテスト
4. **スプレッドシート確認**: 各操作後にデータが正確に記録されているか確認

### 13.3. 動作確認チェックリスト

- [ ] デプロイURLにスマホでアクセス可能
- [ ] 出勤ボタンをタップ→スプレッドシート・LINEを確認
- [ ] 退勤ボタンをタップ→勤務時間計算を確認
- [ ] 課題完了ボタンをタップ→LINE通知を確認
- [ ] PWAとしてホーム画面に追加可能
- [ ] エラーメッセージが適切に表示される

---

## 14. 今後の拡張案

| 項目 | 説明 | 優先度 |
|------|------|--------|
| ユーザー認証 | LINE Login連携 | 高 |
| 複数ユーザー対応 | ユーザーIDの動的切り替え | 高 |
| 打刻履歴表示 | カレンダーUI・月次集計 | 中 |
| 休憩時間管理 | 休憩開始・終了ボタン追加 | 中 |
| 位置情報記録 | Geolocation APIで打刻位置を記録 | 低 |
| オフライン打刻 | localStorageで一時保存→同期 | 低 |
| プッシュ通知 | Web Push APIで打刻リマインド | 低 |

---

## 15. 参考資料

### 15.1. 公式ドキュメント

- [Google Apps Script公式ドキュメント](https://developers.google.com/apps-script)
- [LINE Messaging API](https://developers.line.biz/ja/docs/messaging-api/)
- [PWA - MDN Web Docs](https://developer.mozilla.org/ja/docs/Web/Progressive_web_apps)
- [Service Worker API](https://developer.mozilla.org/ja/docs/Web/API/Service_Worker_API)
- [Google Spreadsheet Service](https://developers.google.com/apps-script/reference/spreadsheet)

### 15.2. LINE通知テンプレート（再掲）

**出勤通知**
```
【出勤】
田中太郎
2025/10/05 09:05
```

**退勤通知**
```
【退勤】
田中太郎
出勤：09:05
退勤：18:10
勤務：9時間5分
```

**課題完了通知**
```
【🎉課題完了報告🎉】
研修生：田中太郎（user01）
完了：2025/10/05 15:30

アプリURL:
https://your-github-username.github.io/attendance-app
```

---

## 16. 付録

### 16.1. よくあるエラーと対処法

| エラー内容 | 原因 | 対処法 |
|-----------|------|--------|
| LINE通知が届かない | トークン/グループIDが間違っている | 設定値を再確認、Bot招待を確認 |
| スプレッドシートに記録されない | スプレッドシートIDが間違っている | URLからIDを再取得 |
| PWAインストールできない | manifest.jsonが読み込めない | デプロイURLを確認、HTTPSか確認 |
| 勤務時間が0になる | 出勤記録が見つからない | 出勤打刻を先に実施 |

### 16.2. セキュリティベストプラクティス

- アクセストークンは環境変数やプロパティストアに保存（本番環境）
- Google Apps Scriptのアクセス制限を適切に設定
- 定期的なパスワード・トークンのローテーション
- LINEグループIDの漏洩防止

---

**文書履歴**

| 版 | 日付 | 作成者 | 変更内容 |
|----|------|--------|----------|
| 1.0 | 2025/01/15 | - | 初版作成 |
| 2.0 | 2025/11/09 | - | システム運用、テスト、付録セクションを追加 |
